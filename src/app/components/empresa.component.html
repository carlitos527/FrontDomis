<div class="container mt-4">

  <h2 class="text-center fw-bold mb-4 text-primary">Empresas</h2>

  <!-- Botón de agregar -->
  <div class="text-end mb-3">
    <button class="btn btn-outline-primary rounded-pill px-4"
            (click)="mostrarFormulario.set(!mostrarFormulario())">
      {{ mostrarFormulario() ? 'Cancelar' : 'Agregar Empresa' }}
    </button>
  </div>

  <!-- Formulario -->
  <div *ngIf="mostrarFormulario()" class="card p-4 mb-4 shadow-sm">
    <h5 class="text-primary mb-3">Registrar Nueva Empresa</h5>
    <form (ngSubmit)="crearEmpresa()" #empresaForm="ngForm">
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label fw-semibold">Nombre</label>
          <input type="text" class="form-control" [(ngModel)]="nuevaEmpresa.nombre"
                 name="nombre" required placeholder="Ej. Mi Empresa" #nombre="ngModel"/>
          <div *ngIf="nombre.invalid && nombre.touched" class="text-danger small">
            El nombre es obligatorio.
          </div>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-semibold">Dirección</label>
          <input type="text" class="form-control" [(ngModel)]="nuevaEmpresa.direccion"
                 name="direccion" placeholder="Calle 123"/>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-semibold">Teléfono</label>
          <input type="text" class="form-control" [(ngModel)]="nuevaEmpresa.telefono"
                 name="telefono" placeholder="3001234567"/>
        </div>
      </div>

      <div class="text-end mt-3">
        <button class="btn btn-success" type="submit" [disabled]="empresaForm.invalid">
          Guardar
        </button>
      </div>
    </form>
  </div>

  <!-- Mensaje de carga -->
  <div *ngIf="loading()" class="text-center my-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <!-- Lista de empresas -->
  <div class="row g-3">
    <div *ngFor="let e of empresas()" class="col-md-4">
      <div class="card p-3 shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">{{ e.nombre }}</h5>
          <p class="card-text mb-1"><strong>Dirección:</strong> {{ e.direccion || 'N/A' }}</p>
          <p class="card-text mb-3"><strong>Teléfono:</strong> {{ e.telefono || 'N/A' }}</p>
          <button class="btn btn-outline-danger btn-sm" (click)="eliminarEmpresa(e.empresaID!)">
            Eliminar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Error -->
  <div *ngIf="error()" class="alert alert-danger mt-4 text-center">
    {{ error() }}
  </div>

</div>
